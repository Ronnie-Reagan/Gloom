-- Function to create an image from a grid array
local function createImageFromArray(width, height, array, colorMap)
    local imageData = love.image.newImageData(width, height)

    for y = 0, height - 1 do
        -- Ensure the row exists in the array
        local row = array[y + 1]
        if row then
            for x = 0, width - 1 do
                -- Ensure the character exists in the row
                local char = row:sub(x + 1, x + 1)
                local color = colorMap[char]
                if color then
                    imageData:setPixel(x, y, unpack(color))
                end
            end
        end
    end

    return love.graphics.newImage(imageData)
end

-- Define the color map for each character
local colorMap = {
    ["0"] = { 0, 0, 0, 0 },       -- Transparent
    ["1"] = { 0, 0, 0, 1 },       -- Black
    ["2"] = { 0.5, 0.5, 0.5, 1 }, -- Gray
    ["3"] = { 1, 1, 1, 1 },       -- White
    ["4"] = { 1, 0, 0, 1 },       -- Red
    ["5"] = { 0, 1, 0, 1 },       -- Green
    ["6"] = { 0, 0, 1, 1 },       -- Blue
    ["7"] = { 1, 1, 0, 1 },       -- Yellow
    ["8"] = { 0, 1, 1, 1 },       -- Cyan
    ["9"] = { 1, 0, 1, 1 },       -- Magenta
}

local gunRearViewArray = {
    "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
    "0000000000000000000000000000000000000000000000064480000000000000000000000000000000000000000000000000",
    "0000000000000000000000000000000000000000092333543553333600000000000000000000000000000000000000000000",
    "0000000000000000000000000000000000000000053333222233333280000000000000000000000000000000000000000000",
    "0000000000000000000000000000000000000000923333333333333340000000000000000000000000000000000000000000",
    "0000000000000000000000000000000000000000511111111111111134800000000000000000000000000000000000000000",
    "0000000000000000000000000000000000000005333333333333333333500000000000000000000000000000000000000000",
    "0000000000000000000000000000000000000005133333333333333333200000000000000000000000000000000000000000",
    "0000000000000000000000000000000000000083333317777777713333390000000000000000000000000000000000000000",
    "0000000000000000000000000000000000000051333317777777713333119000000000000000000000000000000000000000",
    "0000000000000000000000000000000000000613222237777777712222213800000000000000000000000000000000000000",
    "0000000000000000000000000000000000000532222237777777712222221600000000000000000000000000000000000000",
    "0000000000000000000000000000000000008322225537777777712222222500000000000000000000000000000000000000",
    "0000000000000000000000000000000000006222525537771177712222222280000000000000000000000000000000000000",
    "0000000000000000000000000000000000004255555377113111112252222290000000000000000000000000000000000000",
    "0000000000000000000000000000000000005377355527111111115553771290000000000000000000000000000000000000",
    "0000000000000000000000000000000000842255155521322333335553322248000000000000000000000000000000000000",
    "0000000000000000000000000000000000652131355521255525235553711134000000000000000000000000000000000000",
    "0000000000000000000000000000000008446117125521544444235553111543900000000000000000000000000000000000",
    "0000000000000000000000000000000009522455555521222222335555552223500000000000000000000000000000000000",
    "0000000000000000000000000000000004522455555527133333115255552223280000000000000000000000000000000000",
    "0000000000000000000000000000000009522455555527777777712555252223600000000000000000000000000000000000",
    "0000000000000000000000000000000000842423225521111111132553222222800000000000000000000000000000000000",
    "0000000000000000000000000000000000092422255555555555555552222250000000000000000000000000000000000000",
    "0000000000000000000000000000000000006552255555555525522222222590000000000000000000000000000000000000",
    "0000000000000000000000000000000000000945222555555555522222224000000000000000000000000000000000000000",
    "0000000000000000000000000000000000000864452222333233332225468000000000000000000000000000000000000000",
    "0000000000000000000000000000000000000865552223111111332225548000000000000000000000000000000000000000",
    "0000000000000000000000000000000000000845225552333333322222548000000000000000000000000000000000000000",
    "0000000000000000000000000000000000000942225555522222222222259000000000000000000000000000000000000000"
}
-- Example grid array representing the image
local gunSideViewArray = {
    "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
    "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
    "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
    "0000000000000000008314000000000000000000000000000000000000000000000000000000000000006900000000000000",
    "0000000000000004777311111111111111111111111111111111111111111111111111111111111111111133900000000000",
    "0000000000000004711333333333233233222222222222222222222222222222222222222222222222222225580000000000",
    "0000000000000004713333333332222222222222222222222222222222222222222222222222222222222225290000000000",
    "0000000000000004713333333332222233222222222222222222222222222222222222222222222222222225200000000000",
    "0000000000000002777111131313333333332233333333333333222223332222222222222222225555555555600000000000",
    "0000000000000081711333222222222222222225222222222222255233322222222522222222222222222222900000000000",
    "0000000000000008523171322222222222333332422222222222552331222222525523333333333133333311000000000000",
    "0000000000000000000931712222222222222222222222222222255333323333333331111111111111113336000000000000",
    "0000000000000000000002773255552222333322254523333322544642113356999966666669998988800000000000000000",
    "0000000000000000000006171255522223333332442333320000000000412600000000000000000000000000000000000000",
    "0000000000000000000006311313222233333554421412390000000000813800000000000000000000000000000000000000",
    "0000000000000000000005771233133332255525233893350000000000813900000000000000000000000000000000000000",
    "0000000000000000000081773222222222222232322506314000000000413600000000000000000000000000000000000000",
    "0000000000000000000047712222222222222523323132469999664423333500000000000000000000000000000000000000",
    "0000000000000000000877732222222222225422600006222255544444666900000000000000000000000000000000000000",
    "0000000000000000000217122222222222254529000000000000000000000000000000000000000000000000000000000000",
    "0000000000000000005171332222222222245240000000000000000000000000000000000000000000000000000000000000",
    "0000000000000000051713232222222222552340000000000000000000000000000000000000000000000000000000000000",
    "0000000000000000277122222222222225522490000000000000000000000000000000000000000000000000000000000000",
    "0000000000000061711322323232222225226000000000000000000000000000000000000000000000000000000000000000",
    "0000000000000617132222232232222255220000000000000000000000000000000000000000000000000000000000000000",
    "0000000000006771322222222222222552329000000000000000000000000000000000000000000000000000000000000000",
    "0000000000081713222232322222222522600000000000000000000000000000000000000000000000000000000000000000",
    "0000000000037132222222222222225534000000000000000000000000000000000000000000000000000000000000000000",
    "0000000000411132222223222322255229000000000000000000000000000000000000000000000000000000000000000000",
    "0000000008271322322222222223255250000000000000000000000000000000000000000000000000000000000000000000",
    "0000000000577322222222222223255380000000000000000000000000000000000000000000000000000000000000000000",
    "0000000000005233333333333331322800000000000000000000000000000000000000000000000000000000000000000000",
    "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
    "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
}
-- Create the image from the array
local gunSideView = createImageFromArray(64, 32, gunSideViewArray, colorMap)
local gunRearView = createImageFromArray(64, 32, gunRearViewArray, colorMap)

-- Adding the gun perspectives to the Assets table
local Assets = { gun = {} }
Assets.gun.sideView = gunSideView
Assets.gun.rearView = gunRearView

-- Example usage
-- love.graphics.draw(Assets.gun.sideView, 100, 100)
local CONFIG = {
    -- Game Variables
    GAME = {
        hardMode = false,
        timePlayed = 0,
        debug = true
    },

    -- Window Settings
    WINDOW = {
        windowWidth = 1280,
        windowHeight = 720,
        windowTitle = "GLOOM V 0.001",
        defaultWidth = 1280,
        defaultHeight = 720
    },

    -- Colours
    COLOURS = {
        red = { 1, 0, 0 },
        green = { 0, 1, 0 },
        blue = { 0, 0, 1 },
        orange = { 1, 0.5, 0 },
        yellow = { 1, 1, 0 },
        violet = { 0.5, 0, 1 },
        indigo = { 0.3, 0, 0.5 },
        white = { 1, 1, 1 },
        black = { 0, 0, 0 },
        grey = { 0.5, 0.5, 0.5 }
    },

    -- Level Configuration
    LEVELS = {
        currentLevel = 1,
        totalLevels = 3,
        maps = {
            {
                name = "Level 1",
                layout = {
                    { 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 },
                    { 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 },
                    { 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1 },
                    { 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1 },
                    { 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1 },
                    { 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 },
                    { 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1 },
                    { 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1 },
                    { 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1 },
                    { 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 },
                    { 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 }
                }
            },
            {
                name = "Level 2",
                layout = {
                    { 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 },
                    { 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 },
                    { 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1 },
                    { 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1 },
                    { 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 1, 0, 1 },
                    { 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1 },
                    { 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 1, 0, 1 },
                    { 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1 },
                    { 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1 },
                    { 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 },
                    { 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 }
                }
            },
            {
                name = "Level 3",
                layout = {
                    { 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 },
                    { 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 },
                    { 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1 },
                    { 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1 },
                    { 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1 },
                    { 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 },
                    { 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1 },
                    { 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1 },
                    { 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1 },
                    { 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 },
                    { 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 }
                }
            }
        }
    },

    -- Heads Up Display
    HUD = {
        map = {
            x = 20,
            y = 20,
            height = 90,
            width = 90,
            blips = { size = 10 }
        },
        ammo = {
            x = 1160,
            y = 680,
            height = 20,
            width = 120,
            textScale = 100,
            backgroundOpacity = 50
        },
        health = {
            x = 1040,
            y = 700,
            width = 240,
            height = 20
        }
    },

    -- Main Menu
    MENU = {
        options = {
            { label = "START",      action = "startGame" },
            { label = "HIGHSCORES", action = "showHighScores" },
            { label = "SETTINGS",   action = "openSettings" },
            { label = "QUIT",       action = "quitGame" }
        },
        button = {
            height = 50,
            width = 200,
            textScale = 100,
            spacing = 10,
            fontSize = 14,
            textColour = { 1, 1, 1 },
            defaultColour = { 0.5, 0.5, 0.5 },
            selectedColour = { 0.7, 0.7, 0.7 },
            selectedTextColour = { 1, 1, 1 }
        },
        settings = {
            mouseSensitivityX = 3 * 0.002,
            mouseSensitivityY = 2 * 0.002,
            resolution = { width = 800, height = 600 },
            fov = math.pi / 3,
            showSettings = false,
            options = {
                {
                    label = "Resolution",
                    values = {
                        "800x600",
                        "1024x768",
                        "1280x720",
                        "1920x1080",
                        "3840x2160"
                    },
                    selected = 1
                },
                {
                    label = "Field of View",
                    values = {
                        "40",
                        "60",
                        "80",
                        "100",
                        "120"
                    },
                    selected = 2
                }
            }
        }
    },

    -- Player Data
    PLAYER = {
        alive = true,
        health = 100,
        speed = 12, -- Meters per second
        position = { x = nil, y = nil, z = nil },
        ammoCount = 50,
        regeneration = true,
        regenMultiplier = 1
    },

    -- Weapon Data
    WEAPONS = {
        PISTOL = {
            fireRate = 1.5,
            sideView = gunSideView,
            rearView = gunRearView,
            range = 100,
            magazine = 12,
            damage = 10,
            reloadTime = 2,
            ammo = { damage = 5, range = 100, speed = 300 },
            adsPos = {
                sightX = 2,
                sightY = 1,
                sightZ = 0,
                magnification = 1.5
            }
        },
        BOLT = {
            fireRate = 4,
            range = 100,
            damage = 50,
            magazine = 30,
            reloadTime = 3.5,
            ammo = { damage = 24, range = 450, speed = 800 },
            adsPos = {
                sightX = 2,
                sightY = 1,
                sightZ = 0,
                magnification = 3
            }
        },
        JK_SIXTY_NINE = {
            fireRate = 3.6,
            magazine = 30,
            reloadTime = 3,
            damage = 55,
            range = 100,
            ammo = { damage = 25, range = 250, speed = 800 },
            adsPos = {
                sightX = 2,
                sightY = 1,
                sightZ = 0,
                magnification = 2.5
            }
        },
        REVOLVER = {
            fireRate = 1,
            damage = 10,
            range = 100,
            magazine = 5,
            reloadTime = 2.5,
            ammo = { damage = 12, range = 80, speed = 280 },
            adsPos = {
                sightX = 2,
                sightY = 1,
                sightZ = 0,
                magnification = 1.5
            }
        }
    },

    -- Enemy Data
    ENEMY = {
        type = {
            grunt = { health = 50, speed = 50, damage = 15, chance = 50 },
            soldier = { health = 100, speed = 100, damage = 30, chance = 45 },
            boss = { health = 250, speed = 75, damage = 50, chance = 5 }
        }
    }
}

-- Health Colour Function
function CONFIG:getHealthColour(health)
    if health < 1 then
        return self.COLOURS.black
    elseif health < 25 then
        return self.COLOURS.red
    elseif health < 50 then
        return self.COLOURS.yellow
    else
        return self.COLOURS.green
    end
end

-- Resolution and FOV functions
function CONFIG:getResolutions()
    return self.MENU.settings.options[1].values
end

function CONFIG:getFOVs()
    return self.MENU.settings.options[2].values
end

function CONFIG:setResolution(index)
    local resolution = self:getResolutions()[index]
    local width, height = resolution:match("(%d+)x(%d+)")
    love.window.setMode(tonumber(width), tonumber(height))
end

function CONFIG:setFOV(index)
    local fov = self:getFOVs()[index]
    self.MENU.settings.fov = math.rad(tonumber(fov))
end

return CONFIG
